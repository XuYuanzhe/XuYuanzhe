# JJSang Notes




<!-- markdown-toc end -->


## ğŸ§® æ•°æ®ç»“æ„ & ç®—æ³•ï¼ˆç¨‹åº = æ•°æ®ç»“æ„ + ç®—æ³•ï¼‰

#### äºŒå‰æŸ¥æ‰¾æ ‘çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ
> å¹³è¡¡çŠ¶æ€ä¸‹ä¸º `O(logn)` èŠ‚ç‚¹åˆ†å¸ƒå¤±è¡¡ä¼šé€€åŒ–åˆ° O(n) åœ¨ä¸€æ¡é“¾ä¸Š  

#### åœ¨ `O(logn)` ä¸­çš„ log æ˜¯ä»¥ä»€ä¹ˆä¸ºåº•ï¼Ÿ  
> ä»¥ 2 ä¸ºåº• n çš„å¯¹æ•° = ä»¥ 2 ä¸ºåº• 10 çš„å¯¹æ•° * ä»¥ 10 ä¸ºåº• n çš„å¯¹æ•°  
> ä»¥ 2 ä¸ºåº• 10 çš„å¯¹æ•°æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¿™é‡Œå¿½ç•¥å¸¸æ•°é¡¹ç³»æ•°  
> log ä»¥ i ä¸ºåº• n çš„å¯¹æ•°ç­‰äº log ä»¥ j ä¸ºåº• n çš„å¯¹æ•°ï¼Œæ‰€ä»¥å¿½ç•¥äº† iï¼Œç›´æ¥è¯´æ˜¯logn

#### è¿™é‡Œçš„ n æ˜¯æŒ‡ï¼Ÿ
> n ä¸ªèŠ‚ç‚¹

#### äºŒå‰æŸ¥æ‰¾æ ‘å’ŒäºŒåˆ†æ³•å“ªä¸ªé€Ÿåº¦æ›´å¿«ï¼Ÿ
> ä¸¤è€…æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(logn)  
> ä¸¤è€…æ˜æ˜¾çš„åŒºåˆ«æ˜¯äºŒåˆ†æŸ¥æ‰¾é€Ÿåº¦å¿«åˆ é™¤å’Œæ’å…¥å›°éš¾ï¼Œå¯¹äºå»ºç«‹çš„äºŒå‰æ ‘ç´¢å¼•æ¥è¯´ï¼Œä»–çš„æ’å…¥å’Œåˆ é™¤æ˜¯ç›¸å¯¹è¾ƒå¿«çš„ã€‚

#### ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸¤è€…çš„å·®åˆ«ï¼Ÿ
> ä»ç©ºé—´æ€§èƒ½ï¼Œé¡ºåºå­˜å‚¨ä¼šå¯¹ç©ºé—´èµ„æºåšåˆ°ç™¾åˆ†ä¹‹ç™¾çš„åˆ©ç”¨ï¼Œè€Œé“¾å¼å­˜å‚¨å¯¹å¯¹ç©ºé—´çš„åˆ©ç”¨ä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾ï¼Œå› ä¸ºå­˜å‚¨äº†æŒ‡é’ˆï¼Œä¸æ˜¯çœŸæ­£çš„æ•°æ®ï¼›  
> ä»æ—¶é—´æ€§èƒ½ä¸Šæ¥è®²è¯»å–é€Ÿåº¦çš„è¯é¡ºåºå­˜å‚¨æ›´ä¼˜ï¼Œæ’å…¥å’Œåˆ é™¤æ“ä½œé“¾å¼å­˜å‚¨æ›´ä¼˜ï¼Œé“¾å¼å­˜å‚¨åªéœ€è¦ç§»åŠ¨æŒ‡é’ˆï¼Œä¸éœ€è¦ç§»åŠ¨å…ƒç´ ã€‚

#### ä»€ä¹ˆæ—¶å€™é‡‡ç”¨äºŒåˆ†ä»€ä¹ˆæ—¶å€™é‡‡ç”¨äºŒå‰ç´¢å¼•ï¼Ÿ
> å¦‚æœæ•°æ®æ˜¯ä¸è¿›è¡Œé¢‘ç¹å˜åŒ–ä¸”æ˜¯æœ‰åºï¼Œè€Œä¸”æŸ¥è¯¢ç›¸å¯¹è¾ƒå¤šçš„æƒ…å†µä¸‹é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼›  
> æ•°æ®æ˜¯é¢‘ç¹å˜åŒ–çš„è€ƒè™‘åˆ°åé¢çš„æ•°æ®æ‰©å®¹çš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘é‡‡ç”¨äºŒå‰ç´¢å¼•çš„æ–¹å¼ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ç‚¹ç©ºé—´èµ„æºçš„ç‰ºç‰²ã€‚

#### äºŒå‰æ ‘çš„éå†æ–¹å¼æœ‰å“ªäº›ï¼Ÿå®ç°ä¸€ä¸‹ä»£ç ï¼Ÿ
> å‰ã€ä¸­ã€ååºéå†
```python
# äºŒå‰æ ‘ä¸­åºéå†çš„é€’å½’ value  left  right
def inorder(root):
    if not root:
        return 
    inorder(root.left)
    print(root.val)
    inorder(root.right)
    
# äºŒå‰æ ‘å…ˆåºéå†çš„é€’å½’ left  value  right
def preorder(root):
    if not root:
        return 
    print(root.val)
    preorder(root.left)
    preorder(root.right)
   
# äºŒå‰æ ‘ååºéå†çš„é€’å½’ left  right value
def postorder(root):
    if not root:
        return 
    postorder(root.left)
    postorder(root.right)
    print(root.val)
```
#### æ€ä¹ˆåˆ¤æ–­äºŒå‰æ ‘å¹³è¡¡ï¼Ÿ
> å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼å‡ä¸è¶…è¿‡ 1

#### ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Ÿ
> å¹³è¡¡äºŒå‰æ ‘åˆå« AVL æ ‘ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå¯ä»¥è‡ªåŠ¨è°ƒèŠ‚å¹³è¡¡ã€‚  
> AVL æ ‘ç»´æŒç€ä¸¥æ ¼çš„å¹³è¡¡ï¼Œä»»æ„èŠ‚ç‚¹ä¸¤é¢—å­æ ‘çš„é«˜åº¦å·®éƒ½ä¸è¶…è¿‡ 1ã€‚  
> ä¼˜ç‚¹æ˜¯ä¿è¯äº†æŸ¥è¯¢æ•ˆç‡ï¼Œç¼ºç‚¹æ˜¯ç»´æŒå¹³è¡¡æˆæœ¬è¾ƒé«˜ï¼Œé€‚åˆæŸ¥è¯¢è¾ƒå¤šçš„åœºæ™¯ã€‚

---

#### ä»€ä¹ˆæ˜¯çº¢é»‘æ ‘ï¼Ÿ
> æ˜¯å¦ä¸€ç§å¯ä»¥è‡ªåŠ¨è°ƒæ•´å¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚ä¼˜ç‚¹æ˜¯é™ä½äº†ç»´æŒå¹³è¡¡çš„æˆæœ¬ï¼Œç¼ºç‚¹æ˜¯æŸ¥è¯¢æ•ˆç‡åº•ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤çš„åœºæ™¯ã€‚

#### çº¢é»‘æ ‘å’ŒAVLæ ‘çš„ä¸åŒ?
> AVLæ˜¯ä¸¥æ ¼å¹³è¡¡æ ‘ï¼Œå› æ­¤åœ¨å¢åŠ æˆ–è€…åˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ ¹æ®ä¸åŒæƒ…å†µï¼Œæ—‹è½¬çš„æ¬¡æ•°æ¯”çº¢é»‘æ ‘è¦å¤šï¼›  
> çº¢é»‘æ˜¯ç”¨éä¸¥æ ¼çš„å¹³è¡¡æ¥æ¢å–å¢åˆ èŠ‚ç‚¹æ—¶å€™æ—‹è½¬æ¬¡æ•°çš„é™ä½ï¼›

#### çº¢é»‘æ ‘æœ‰ä»€ä¹ˆæ›´æ·±åˆ»ç†è§£?
> çº¢é»‘æ ‘è¯¦è§£: https://xieguanglei.github.io/blog/post/red-black-tree.html
---

#### ä»€ä¹ˆæ˜¯Bæ ‘å’ŒB+æ ‘ï¼Ÿ
> Bæ ‘è§£å†³äº†ä»ç£ç›˜æµ·é‡æ•°æ®ä¸­æŸ¥è¯¢çš„éœ€æ±‚ï¼Œæœ‰æ•ˆå‡å°‘äº†ç£ç›˜ I/O çš„é¢‘æ¬¡ã€‚  
> B+æ ‘æ˜¯Bæ ‘çš„å‡çº§ï¼Œå¶å­ç»“ç‚¹åŒ…æ‹¬å…¨é‡æ•°æ®ï¼Œå¹¶ä½¿ç”¨åŒå‘æŒ‡é’ˆè¿æ¥ç›¸é‚»èŠ‚ç‚¹ï¼Œä¸ºèŒƒå›´æŸ¥è¯¢æä¾›äº†ä¾¿åˆ©ã€‚

## â˜ï¸ è®¡ç®—æœºç½‘ç»œ

#### ä¸ºä»€ä¹ˆæœ‰ TCP/IP å››å±‚æ¨¡å‹ï¼Ÿ  
> OSI ä¸ƒå±‚åè®®ä½“ç³»ç»“æ„çš„æ¦‚å¿µæ¸…æ¥šï¼Œç†è®ºä¹Ÿæ¯”è¾ƒå®Œæ•´ï¼Œä½†å®ƒæ—¢å¤æ‚åˆä¸å®ç”¨ 

#### å¯¹ TCP/IP å››å±‚æ¨¡å‹çš„ç†è§£ï¼Ÿ
> åº”ç”¨å±‚ï¼ˆæ•°æ®æ®µï¼‰  
> ä¼ è¾“å±‚ï¼ˆæ•°æ®åŒ…ï¼‰  
> ç½‘ç»œå±‚ï¼ˆæ•°æ®å¸§ï¼‰  
> æ•°æ®é“¾è·¯å±‚ï¼ˆæ¯”ç‰¹æµï¼‰

#### å¯¹ OSI ä¸ƒå±‚æ¨¡å‹çš„ç†è§£ï¼Ÿ
- åº”ç”¨å±‚ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼Œç”µå­é‚®ä»¶ï¼Œæ–‡ä»¶æœåŠ¡ï¼Œè™šæ‹Ÿç»ˆç«¯ï¼‰  
TCP/IP åè®®ï¼šTFTPï¼ŒHTTPï¼ŒSNMPï¼ŒFTPï¼ŒSMTPï¼ŒDNSï¼ŒTelnet
- è¡¨ç¤ºå±‚ï¼ˆæ•°æ®æ ¼å¼åŒ–ï¼Œä»£ç è½¬æ¢ï¼Œæ•°æ®åŠ å¯†ï¼‰  
TCP/IP åè®®ï¼šæ²¡æœ‰åè®®
- ä¼šè¯å±‚ï¼ˆè§£é™¤æˆ–å»ºç«‹ä¸åˆ«çš„æ¥ç‚¹çš„è”ç³»ï¼‰  
TCP/IP åè®®ï¼šæ²¡æœ‰åè®®
- ä¼ è¾“å±‚ï¼ˆæä¾›ç«¯å¯¹ç«¯çš„æ¥å£ï¼‰  
TCP/IP åè®®ï¼šTCPï¼ŒUDP

  |            | TCP                                              | UDP                                        |
  | ---------- | ------------------------------------------------ | ------------------------------------------ |
  | å¯é æ€§     | å¯é                                              | ä¸å¯é                                      |
  | è¿æ¥æ€§     | é¢å‘è¿æ¥                                         | æ— è¿æ¥                                     |
  | æ•ˆç‡       | ä¼ è¾“æ•ˆç‡ä½                                       | ä¼ è¾“æ•ˆç‡é«˜                                 |
  | åŒå·¥æ€§     | å…¨åŒå·¥                                           | ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤š             |
  | ä¼ è¾“é€Ÿåº¦   | æ…¢                                               | å¿«                                         |
  | åº”ç”¨åœºæ™¯   | å¯¹æ•ˆç‡è¦æ±‚ä½ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚é«˜æˆ–è€…è¦æ±‚æœ‰é“¾æ¥çš„åœºæ™¯ | å¯¹æ•ˆç‡è¦æ±‚é«˜ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚ä½çš„åœºæ™¯         |
  | åº”ç”¨å±‚åè®® | SMTPç”µå­é‚®ä»¶/HTTPä¸‡ç»´ç½‘/FTPæ–‡ä»¶ä¼ è¾“              | DNSåŸŸåè½¬æ¢/TFTPæ–‡ä»¶ä¼ è¾“/NFSè¿œç¨‹æ–‡ä»¶æœåŠ¡å™¨ |

- ç½‘ç»œå±‚ï¼ˆä¸ºæ•°æ®åŒ…é€‰æ‹©è·¯ç”±ï¼‰  
TCP/IP åè®®ï¼šIPï¼ŒICMPï¼ŒRIPï¼ŒOSPFï¼ŒBGPï¼ŒIGMP
  - è·¯ç”±å™¨	æ‹¥æœ‰ç‹¬ç«‹MACå¸®åŠ©è½¬å‘ï¼Œæœ¬èº«æ²¡æœ‰ä¼ è¾“åŒ…çš„åŠŸèƒ½å®é™…ä¼ è¾“æ˜¯å§”æ‰˜ç»™æ•°æ®é“¾è·¯å±‚çš„
  - IPåè®®æ˜¯ä¸å¯é åè®®ï¼Œæ•°æ®å¤„ç†è¢«è®¤ä¸ºæ˜¯ä¸Šå±‚åè®®è¦åšçš„äº‹
  - 32ä½IPåœ°å€åˆ†ä¸ºç½‘ç»œä½å’Œåœ°å€ä½ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è·¯ç”±è¡¨è®°å½•çš„æ•°ç›®
    - Aç±»IPåœ°å€ï¼š0.0.0.0 ï½ 1 27.0.0.0
    - Bç±»IPåœ°å€ï¼š128.0.0.1 ï½ 191.255.0.0
    - Cç±»IPåœ°å€ï¼š192.168.0.0 ï½ 239.255.255.0
- æ•°æ®é“¾è·¯å±‚ï¼ˆä¼ è¾“æœ‰åœ°å€çš„å¸§ä»¥åŠé”™è¯¯æ£€æµ‹åŠŸèƒ½ï¼‰  
SLIPï¼ŒCSLIPï¼ŒPPPï¼ŒARPï¼ŒRARPï¼ŒMTU
  - äº¤æ¢æœº	é€šè¿‡ç»´æŠ¤ä¸€å¼ MACåœ°å€è¡¨ï¼Œåªå‘é€ç»™ç›®æ ‡MACåœ°å€æŒ‡å‘çš„é‚£ä¸€å°ç”µè„‘ï¼ˆä»¥å¤ªç½‘ï¼‰
- ç‰©ç†å±‚ï¼ˆä»¥äºŒè¿›åˆ¶æ•°æ®å½¢å¼åœ¨ç‰©ç†åª’ä½“ä¸Šä¼ è¾“æ•°æ®ï¼‰  
TCP/IP åè®®ï¼šISO2110ï¼ŒIEEE802ï¼ŒIEEE802.2
  - é›†çº¿å™¨	æ— è„‘å°†ä¿¡å·è½¬å‘ç»™æ‰€æœ‰MACåœ°å€

#### TCP & UDP çš„åŒºåˆ«
1. TCPæä¾›é¢å‘è¿æ¥çš„ä¼ è¾“ï¼Œé€šä¿¡å‰è¦å…ˆå»ºç«‹è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼‰ï¼›UDPæä¾›æ— è¿æ¥çš„ä¼ è¾“ï¼Œé€šä¿¡å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ã€‚
2. TCPæä¾›å¯é çš„ä¼ è¾“ï¼ˆæœ‰åºï¼Œæ— å·®é”™ï¼Œä¸ä¸¢å¤±ï¼Œä¸é‡å¤ï¼‰ï¼›UDPæä¾›ä¸å¯é çš„ä¼ è¾“ã€‚
3. TCPé¢å‘å­—èŠ‚æµçš„ä¼ è¾“ï¼Œå› æ­¤å®ƒèƒ½å°†ä¿¡æ¯åˆ†å‰²æˆç»„ï¼Œå¹¶åœ¨æ¥æ”¶ç«¯å°†å…¶é‡ç»„ï¼›UDPæ˜¯é¢å‘æ•°æ®æŠ¥çš„ä¼ è¾“ï¼Œæ²¡æœ‰åˆ†ç»„å¼€é”€ã€‚
4. TCPæä¾›æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶æœºåˆ¶ï¼›UDPä¸æä¾›æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶æœºåˆ¶ã€‚

---
#### selectå’Œepollä½ äº†è§£ä¹ˆï¼ŒåŒºåˆ«åœ¨å“ª?
pass

#### http åè®®åœ¨å“ªä¸€å±‚æ¨¡å‹ä¸­ï¼Ÿ
> http åè®®æ˜¯ä¸€ç§åº”ç”¨å±‚åè®®æ„å»ºåœ¨ TCP åè®®ä¹‹ä¸Š,ä¸»è¦æ˜¯ç”¨é€”å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„æ²Ÿé€š.

#### http åè®®çš„ç‰¹ç‚¹æœ‰å“ªäº›ï¼Ÿ
pass

#### http åè®®ä¸åŒç‰ˆæœ¬çš„åŒºåˆ«ï¼Ÿ
- HTTP1.1é»˜è®¤ä½¿ç”¨é•¿è¿æ¥ï¼Œå¯æœ‰æ•ˆå‡å°‘TCPçš„ä¸‰æ¬¡æ¡æ‰‹å¼€é”€ã€‚
- HTTP 1.1æ”¯æŒåªå‘é€headerä¿¡æ¯(ä¸å¸¦ä»»ä½•bodyä¿¡æ¯)ï¼Œå¦‚æœæœåŠ¡å™¨è®¤ä¸ºå®¢æˆ·ç«¯æœ‰æƒé™è¯·æ±‚æœåŠ¡å™¨ï¼Œåˆ™è¿”å›100ï¼Œå¦åˆ™è¿”å›401ã€‚å®¢æˆ·ç«¯å¦‚æœæ¥å—åˆ°100ï¼Œæ‰å¼€å§‹æŠŠè¯·æ±‚bodyå‘é€åˆ°æœåŠ¡å™¨ã€‚è¿™æ ·å½“æœåŠ¡å™¨è¿”å›401çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥ä¸ç”¨å‘é€è¯·æ±‚bodyäº†ï¼ŒèŠ‚çº¦äº†å¸¦å®½ã€‚
- HTTP2.0å¯¹ header å‹ç¼©ï¼›ä½¿ç”¨å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œå¤šè·¯å¤ç”¨å…è®¸åŒæ—¶é€šè¿‡å•ä¸€çš„ HTTP/2 è¿æ¥å‘èµ·å¤šé‡çš„è¯·æ±‚-å“åº”æ¶ˆæ¯ã€‚

#### https åè®®ä¸­çš„ s æ˜¯ä»€ä¹ˆ?
> SSL/TLS å®‰å…¨å¥—æ¥å­—å±‚ï¼Œä½¿å¾—æŠ¥æ–‡èƒ½å¤ŸåŠ å¯†ä¼ è¾“ã€‚

#### ä¸‰æ¬¡æ¡æ‰‹æ€ä¹ˆç†è§£ï¼Ÿ
1. å®¢æˆ·ç«¯é€šè¿‡å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€ä¸ªSYNæ¥åˆ›å»ºä¸€ä¸ªä¸»åŠ¨æ‰“å¼€ï¼Œä½œä¸ºä¸‰æ¬¡æ¡æ‰‹çš„ä¸€éƒ¨åˆ†ã€‚å®¢æˆ·ç«¯æŠŠè¿™æ®µè¿æ¥çš„åºå·è®¾å®šä¸ºéšæœºæ•° Aã€‚
2. æœåŠ¡å™¨ç«¯åº”å½“ä¸ºä¸€ä¸ªåˆæ³•çš„SYNå›é€ä¸€ä¸ªSYN/ACKã€‚ACK çš„ç¡®è®¤ç åº”ä¸º A+1ï¼ŒSYN/ACK åŒ…æœ¬èº«åˆæœ‰ä¸€ä¸ªéšæœºåºå· Bã€‚
3. å®¢æˆ·ç«¯å†å‘é€ä¸€ä¸ªACKã€‚å½“æœåŠ¡ç«¯å—åˆ°è¿™ä¸ªACKçš„æ—¶å€™ï¼Œå°±å®Œæˆäº†ä¸‰è·¯æ¡æ‰‹ï¼Œå¹¶è¿›å…¥äº†è¿æ¥åˆ›å»ºçŠ¶æ€ã€‚æ­¤æ—¶åŒ…åºå·è¢«è®¾å®šä¸ºæ”¶åˆ°çš„ç¡®è®¤å· A+1ï¼Œè€Œå“åº”åˆ™ä¸º B+1ã€‚

#### å››æ¬¡æŒ¥æ‰‹æ€ä¹ˆç†è§£ï¼Ÿ
1. å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæ•°æ®åˆ†æ®µ, å…¶ä¸­çš„ FIN æ ‡è®°è®¾ç½®ä¸º1. å®¢æˆ·ç«¯è¿›å…¥ FIN-WAIT çŠ¶æ€. è¯¥çŠ¶æ€ä¸‹å®¢æˆ·ç«¯åªæ¥æ”¶æ•°æ®, ä¸å†å‘é€æ•°æ®.
2. æœåŠ¡å™¨æ¥æ”¶åˆ°å¸¦æœ‰ FIN = 1 çš„æ•°æ®åˆ†æ®µ, å‘é€å¸¦æœ‰ ACK = 1 çš„å‰©ä½™æ•°æ®åˆ†æ®µ, ç¡®è®¤æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„ FIN ä¿¡æ¯.
3. æœåŠ¡å™¨ç­‰åˆ°æ‰€æœ‰æ•°æ®ä¼ è¾“ç»“æŸ, å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰ FIN = 1 çš„æ•°æ®åˆ†æ®µ, å¹¶è¿›å…¥ CLOSE-WAIT çŠ¶æ€, ç­‰å¾…å®¢æˆ·ç«¯å‘æ¥å¸¦æœ‰ ACK = 1 çš„ç¡®è®¤æŠ¥æ–‡.
4. å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å‘æ¥å¸¦æœ‰ FIN = 1 çš„æŠ¥æ–‡, è¿”å› ACK = 1 çš„æŠ¥æ–‡ç¡®è®¤, ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨ç«¯æœªæ”¶åˆ°éœ€è¦é‡å‘, è¿›å…¥ TIME-WAIT çŠ¶æ€. æœåŠ¡å™¨æ¥æ”¶åˆ°æŠ¥æ–‡åå…³é—­è¿æ¥. å®¢æˆ·ç«¯ç­‰å¾… 2MSL åæœªæ”¶åˆ°å›å¤, åˆ™è®¤ä¸ºæœåŠ¡å™¨æˆåŠŸå…³é—­, å®¢æˆ·ç«¯å…³é—­è¿æ¥.

---

#### æ€ä¹ˆç†è§£ rpc?
> Remote Procedure Call è¿œç¨‹è¿‡ç¨‹è°ƒç”¨

#### å·²ç»æœ‰ http æœåŠ¡äº†ä¸ºä»€ä¹ˆè¿˜æœ‰ rpc æœåŠ¡ï¼Ÿ
> æœ¬è´¨çš„åŒºåˆ«å°±æ˜¯RPCä¸»è¦æ˜¯åŸºäºTCP/IPåè®®çš„ï¼Œè€ŒHTTPæœåŠ¡ä¸»è¦æ˜¯åŸºäºHTTPåè®®çš„ï¼Œ  
> RPCæ•ˆç‡æ›´é«˜ï¼Œè€ŒHTTPæœåŠ¡å¼€å‘è¿­ä»£ä¼šæ›´å¿«ã€‚  
> RPC è°ƒç”¨å’Œ HTTP è°ƒç”¨çš„åŒºåˆ«ï¼ˆ [HTTP and RPC](https://github.com/XuYuanzhe/XuYuanzhe/blob/main/documents/HTTP&RPC.md) ï¼‰


## ğŸ’¾ æ•°æ®åº“

#### redis å’Œ memcache æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
> redis æ”¯æŒçš„æ•°æ®ç»“æ„æ›´ä¸°å¯Œã€‚memcache åªæ”¯æŒ key-value çš„å­˜å‚¨ï¼›
> redis åŸç”Ÿæ”¯æŒé›†ç¾¤ï¼Œmemcache æ²¡æœ‰åŸç”Ÿçš„é›†ç¾¤æ¨¡å¼ã€‚

#### redis å’Œ MySQL æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
> redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦å¿«ã€‚  
> mysql æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œå­˜æ”¾åœ¨ç£ç›˜é‡Œé¢ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚æ£€ç´¢çš„è¯ï¼Œä¼šæ¶‰åŠåˆ°ä¸€å®šçš„ IOï¼Œæ•°æ®è®¿é—®ä¹Ÿå°±æ…¢ã€‚  
> éœ€è¦æ°¸ä¹…å­˜å‚¨çš„æ•°æ®ä½¿ç”¨MySQL,æ¯”å¦‚ç”¨æˆ·ä¿¡æ¯,æ–‡ç« ç­‰  
> è€Œä¸´æ—¶æ•°æ®æˆ–è€…ç»å¸¸è®¿é—®çš„æ•°æ®å°±ä¼šä½¿ç”¨redis,æ¯”å¦‚ç”¨æˆ·çš„session/æ’è¡Œæ¦œ/è®¿é—®è®¡æ•°/Pub Sub æ„å»ºå®æ—¶æ¶ˆæ¯ç³»ç»Ÿ/ç¼“å­˜ç­‰

#### redis çš„å‡ ç§æ•°æ®ç»“æ„äº†è§£å—ï¼Ÿ
> stringã€setã€zsetã€hashã€list

#### redis ä¸ºä»€ä¹ˆå¿«ï¼Ÿé™¤äº†åŸºäºå†…å­˜æ“ä½œè¿˜æœ‰å…¶ä»–åŸå› å—ï¼Ÿ
> 1.I/O å¤šè·¯å¤ç”¨ï¼Œäº‹ä»¶å¤„ç†å™¨å¤„ç†äº‹ä»¶(è¿™ä¸ªå¯ä»¥ç†è§£ä¸ºæ³¨å†Œçš„ä¸€æ®µå‡½æ•°ï¼Œå®šä¹‰äº†äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™åº”è¯¥æ‰§è¡Œçš„åŠ¨ä½œ)ï¼Œ è¿™é‡Œåˆ†æ´¾äº‹ä»¶å’Œå¤„ç†äº‹ä»¶å…¶å®éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼›  
> 2.çº¯å†…å­˜æ“ä½œæ•ˆç‡é«˜ï¼›  
> 3.å•çº¿ç¨‹åè€Œé¿å…äº†å¤šçº¿ç¨‹åˆ‡æ¢ã€‚

#### ä»‹ç»ä¸€ä¸‹ I/O å¤šè·¯å¤ç”¨çš„æµç¨‹ï¼Ÿ
> ![](https://raw.githubusercontent.com/XuYuanzhe/Figurebed/master/img/20220625232458.png)
> 1.é¦–å…ˆæ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ socket è¯·æ±‚ï¼Œå¤šè·¯å¤ç”¨å™¨å°† socket è½¬ç»™è¿æ¥åº”ç­”å¤„ç†å™¨ï¼›  
> 2.è¿æ¥åº”ç­”å¤„ç†å™¨å°† AE_READABLE äº‹ä»¶ä¸å‘½ä»¤è¯·æ±‚å¤„ç†å™¨å…³è”(è¿™é‡Œæ˜¯æŠŠ socket äº‹ä»¶æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—)ï¼›  
> 3.å‘½ä»¤è¯·æ±‚å¤„ç†å™¨ä» socket ä¸­è¯»åˆ°æŒ‡ä»¤ï¼Œå†å†…å­˜ä¸­æ‰§è¡Œï¼Œå¹¶å°† AE_WRITEABLE äº‹ä»¶ä¸å‘½ä»¤å›å¤å¤„ç†å™¨å…³è”ï¼›  
> 4.å‘½ä»¤å›å¤å¤„ç†å™¨å°†ç»“æœè¿”å›ç»™ socketï¼Œå¹¶è§£é™¤å…³è”ã€‚

#### redis çš„å†…å­˜ç®¡ç†æœºåˆ¶ä¸gcï¼Ÿ
> å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤
- ä¸»åŠ¨è¿‡æœŸï¼ˆå®šæœŸåˆ é™¤ï¼‰ï¼šé»˜è®¤æ¯ 100ms éšæœºæŠ½å–ä¸€äº›è®¾ç½®äº†è¿‡æœŸäº‹ä»¶çš„ key æ£€æŸ¥æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤ã€‚å¦‚æœ 10w ä¸ª key éƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œå…¨éƒ¨æ£€æŸ¥ä¼šå¢é«˜ CPU è´Ÿè½½ã€‚
- è¢«åŠ¨è¿‡æœŸï¼ˆæƒ°æ€§åˆ é™¤ï¼‰ï¼škey è¢«è®¿é—®æ—¶ï¼Œå¦‚æœå‘ç°å®ƒå·²ç»è¿‡æœŸå°±åˆ é™¤ã€‚

> æœ€å¤§å†…å­˜æ·˜æ±°( redis å†…å­˜å ç”¨å¤ªå¤šï¼Œå°±ä¼šè¿›è¡Œå†…å­˜æ·˜æ±°)
- noeviction: å¦‚æœå†…å­˜ä¸è¶³ä»¥å†™å…¥æ•°æ®ï¼Œ æ–°å†™å…¥æ“ä½œç›´æ¥æŠ¥é”™ï¼›  
- allkeys-lru: å†…å­˜ä¸è¶³ä»¥å†™å…¥æ•°æ®ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ key(æœ€å¸¸ç”¨çš„ç­–ç•¥)ï¼›  
- allkeys-random: å†…å­˜ä¸è¶³éšæœºç§»é™¤å‡ ä¸ª keyï¼›  
- volatile-lru: åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼›  
- volatile-random: è®¾ç½®äº†è¿‡æœŸçš„æ—¶é—´çš„ key ä¸­ï¼Œéšæœºç§»é™¤å‡ ä¸ªã€‚

#### redis å¦‚ä½•ä¿è¯é«˜å¹¶å‘åœºæ™¯ï¼Ÿ
> è¯»å†™åˆ†ç¦»ä¿è¯é«˜å¹¶å‘(10W+ QPS)ï¼šå¯¹äºç¼“å­˜æ¥è¯´ä¸€èˆ¬éƒ½æ˜¯æ”¯æ’‘é«˜å¹¶å‘è¯»ï¼Œå†™è¯·æ±‚éƒ½æ˜¯æ¯”è¾ƒå°‘çš„ã€‚master è´Ÿè´£æ¥æ”¶å†™è¯·æ±‚ï¼Œæ•°æ®åŒæ­¥åˆ° slave ä¸Šæä¾›è¯»æœåŠ¡ï¼Œå¢åŠ  slave æœºå™¨å°±å¯ä»¥æ°´å¹³æ‰©å®¹ã€‚
> ![](https://raw.githubusercontent.com/XuYuanzhe/Figurebed/master/img/20220625234713.png)

#### redis å“¨å…µæœ‰äº†è§£å—ï¼Ÿæ˜¯å¹²ä»€ä¹ˆçš„æœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ
> å“¨å…µæ˜¯ redis é›†ç¾¤æ¶æ„çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ï¼Œä¸»è¦æä¾›åŠŸèƒ½ï¼šé›†ç¾¤ç›‘æ§ã€æ¶ˆæ¯é€šçŸ¥ã€æ•…éšœè½¬ç§»ã€é…ç½®ä¸­å¿ƒ
> å“¨å…µè‡³å°‘ä¸‰ä¸ªï¼Œä¿è¯è‡ªå·±çš„é«˜å¯ç”¨ï¼›  
> å“¨å…µ+ä¸»ä»çš„éƒ¨ç½²æ¶æ„æ˜¯ç”¨æ¥ä¿è¯ redis é›†ç¾¤é«˜å¯ç”¨çš„ï¼Œå¹¶éä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼›  
> å“¨å…µ(Sentinel)éœ€è¦é€šè¿‡ä¸æ–­çš„æµ‹è¯•å’Œè§‚å¯Ÿæ‰èƒ½ä¿è¯é«˜å¯ç”¨  

#### ä¸ºä»€ä¹ˆå“¨å…µè‡³å°‘æ˜¯ 3 ä¸ªï¼Œ2 ä¸ªä¸å¯ä»¥å—ï¼Ÿ
> æ»¡è¶³ majority æ‰å¯ä»¥å…è®¸æ•…éšœè½¬ç§»æ‰§è¡Œã€‚2 ä¸ªå“¨å…µçš„ majority æ˜¯ 2ï¼Œå¦‚æœ 2 ä¸ªå“¨å…µéƒ½è¿è¡Œç€å°±å…è®¸æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚å¦‚æœ M1 æ‰€åœ¨çš„æœºå™¨å®•æœºäº†ï¼Œé‚£ä¹ˆ s1 å“¨å…µä¹Ÿå°±æŒ‚äº†ï¼Œåªå‰© s2 ä¸€ä¸ªï¼Œæ²¡æœ‰ majorityl æ¥å…è®¸æ‰§è¡Œæ•…éšœè½¬ç§»ï¼Œè™½ç„¶é›†ç¾¤è¿˜æœ‰ä¸€å°æœºå™¨ R1ï¼Œä½†æ˜¯æ•…éšœè½¬ç§»ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚

#### ç”¨ redis æ¥å®ç°é™åˆ¶ä¸€ä¸ªapiæˆ–é¡µé¢è®¿é—®çš„é¢‘ç‡ï¼Œä¾‹å¦‚å•ipæˆ–å•ç”¨æˆ·ä¸€åˆ†é’Ÿä¹‹å†…åªèƒ½è®¿é—®å¤šå°‘æ¬¡ï¼Ÿ
```
åœ¨redisä¸­ä¿å­˜ä¸€ä¸ªcountå€¼(int)ï¼Œkeyä¸ºuser:$ipï¼Œvalueä¸ºè¯¥ipè®¿é—®çš„æ¬¡æ•°ï¼Œç¬¬ä¸€æ¬¡è®¾ç½®keyçš„æ—¶å€™ï¼Œè®¾ç½®expiresã€‚
countåŠ 1ä¹‹å‰ï¼Œåˆ¤æ–­æ˜¯å¦keyæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨çš„è¯ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š1ã€è¯¥ipæœªè®¿é—®è¿‡ï¼›2ã€è¯¥ipè®¿é—®è¿‡ï¼Œä½†æ˜¯keyå·²ç»è¿‡æœŸäº†ã€‚é‚£ä¹ˆæ­¤æ—¶éœ€è¦å†æ¬¡è®¾ç½®ä¸€æ¬¡expiresã€‚å¦‚æœç”¨æˆ·è®¿é—®çš„æ—¶å€™ï¼Œåˆ¤æ–­countçš„å€¼æ˜¯å¦å¤§äºä¸Šé™ï¼Œå¦‚æœä½äºä¸Šé™ï¼Œå°±å¤„ç†è¯·æ±‚ï¼Œå¦åˆ™å°±æ‹’ç»å¤„ç†è¯·æ±‚ã€‚

# è€ƒè™‘è¿™ç§æƒ…å†µï¼Œå‡è®¾åªå…è®¸ç”¨æˆ·60ç§’å†…è®¿é—®100æ¬¡ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç”¨æˆ·åœ¨ç¬¬1ç§’è®¿é—®äº†1æ¬¡ï¼Œåœ¨ç¬¬59ç§’çš„æ—¶å€™ï¼Œè®¿é—®äº†99æ¬¡ï¼Œç„¶ååœ¨ç¬¬61ç§’çš„æ—¶å€™ï¼Œè®¿é—®äº†100æ¬¡ã€‚å¦‚æœæŒ‰ç…§ç­–ç•¥1çš„æƒ…å†µå¤„ç†ï¼Œç¬¬1~60ç§’ä¹‹é—´æ¥å—äº†100æ¬¡ï¼Œåœ¨ç¬¬61ç§’æ¥æ”¶100æ¬¡è¯·æ±‚ï¼Œæ‰€ä»¥62~120è¿™æ®µæ—¶é—´å†…ï¼Œä¸å†å¤„ç†è¯¥ipçš„è¯·æ±‚ã€‚
# è²Œä¼¼æ²¡é—®é¢˜ï¼Œä½†æ˜¯ï¼Œç»†ç»†æ€è€ƒä¸€ä¸‹ï¼Œç¬¬59ç§’åˆ°61ç§’ä¹‹é—´æ¥å—äº†99+100=199è¯·æ±‚ï¼Œæ—¶é—´é—´éš”åªæœ‰3ç§’ã€‚é‚£ä¹ˆè¿™æ ·çš„è¯ï¼Œæœ€åˆçš„è®¾è®¡å°±å­˜åœ¨é—®é¢˜äº†ã€‚
è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥ä½¿ç”¨redisçš„listï¼ˆåŒå‘é˜Ÿåˆ—ï¼‰æ•°æ®ç»“æ„ï¼Œkeyå°±æ˜¯user:$ipï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªipè®¾ç½®ä¸€ä¸ªåŒå‘é˜Ÿåˆ—ï¼Œæ¯æ¬¡è¯·æ±‚åˆ°è¾¾çš„æ—¶å€™ï¼Œè¿›è¡Œå¦‚ä¸‹åˆ¤æ–­ï¼š
1ã€å¦‚æœlistä¸­çš„å…ƒç´ ä¸ªæ•°å°‘äº100ä¸ªï¼Œé‚£ä¹ˆå°±å°†è¯·æ±‚åˆ°è¾¾æ—¶çš„æ—¶é—´æˆ³Lpushåˆ°listä¸­ã€‚
2ã€å¦‚æœlistä¸­çš„å…ƒç´ å¤šä½™100ä¸ªï¼Œé‚£ä¹ˆï¼Œå°±å–å‡ºLindex(-1)å³æœ€å³è¾¹ï¼Œä¹Ÿå°±æ˜¯100ä¸ªè¯·æ±‚ä¸­æœ€æ—©çš„é‚£ä¸€ä¸ªè¯·æ±‚çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæœ€æ—©çš„æ—¶é—´æˆ³å’Œå½“å‰æ—¶é—´æˆ³ç›¸å·®è¶…è¿‡60ç§’ï¼Œé‚£ä¹ˆè¡¨ç¤ºç¬¬ä¸€ä¸ªè¯·æ±‚å·²ç»è¿‡æœŸäº†ï¼Œå°±å°†ç¬¬ä¸€ä¸ªè¯·æ±‚å‡ºé˜ŸRpopã€‚ç„¶åå°†å½“å‰æ—¶é—´æˆ³å…¥é˜ŸLpush
```

---

#### ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ
> ç´¢å¼•æ˜¯ä¸€ç§å•ç‹¬çš„ï¼Œç‰©ç†çš„å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–è€…å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§å­˜å‚¨ç»“æ„ã€‚  
> ç›¸å½“äºå›¾ä¹¦çš„ç›®å½•ï¼Œå¯ä»¥æ ¹æ®ç›®å½•ä¸­çš„é¡µç å¿«é€Ÿæ‰¾åˆ°éœ€è¦çš„å†…å®¹

#### ä»€ä¹ˆæ˜¯è”åˆç´¢å¼•ï¼Ÿ
> é€šè¿‡ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ï¼ˆéƒ¨é¦–ï¼‰åœ¨ç¬¬ä¸€çº§ç´¢å¼•ä¸­æ‰¾åˆ°å¯¹åº”çš„ç¬¬äºŒçº§ç´¢å¼•ä½ç½®ï¼ˆæ£€å­—è¡¨é¡µç ï¼‰  
> ç„¶ååœ¨ç¬¬äºŒçº§ç´¢å¼•ä¸­æ ¹æ®ç¬¬äºŒä¸ªå­—æ®µçš„å€¼ï¼ˆç¬”ç”»ï¼‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ‰€åœ¨çš„ä½ç½®ï¼ˆæŸä¸ªå­—çš„çœŸæ­£é¡µç ï¼‰ã€‚

#### ä»€ä¹ˆæ˜¯èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•ã€è¦†ç›–ç´¢å¼•?
> åƒæ‹¼éŸ³ç›®å½•è¿™æ ·çš„ç´¢å¼•ï¼Œæ•°æ®ä¼šæ ¹æ®ç´¢å¼•ä¸­çš„é¡ºåºè¿›è¡Œæ’åˆ—å’Œç»„ç»‡çš„ï¼Œè¿™æ ·çš„ç´¢å¼•å°±è¢«ç§°ä¸ºèšé›†ç´¢å¼•ï¼Œè€Œéèšé›†ç´¢å¼•å°±æ˜¯å…¶ä»–çš„ä¸€èˆ¬ç´¢å¼•ã€‚å› ä¸ºæ•°æ®åªèƒ½æŒ‰ç…§ä¸€ç§è§„åˆ™æ’åºï¼Œæ‰€ä»¥ä¸€å¼ è¡¨è‡³å¤šæœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªéèšé›†ç´¢å¼•  
> https://zhuanlan.zhihu.com/p/476444902

#### ä»€ä¹ˆæ˜¯è§†å›¾ï¼Ÿè§†å›¾çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ
> è§†å›¾æ˜¯ä¸€ç§è™šæ‹Ÿçš„è¡¨ï¼Œå…·æœ‰å’Œç‰©ç†è¡¨ç›¸åŒçš„åŠŸèƒ½  
> åªæš´éœ²éƒ¨åˆ†å­—æ®µç»™è®¿é—®è€…ï¼Œæ‰€ä»¥å°±å»ºä¸€ä¸ªè™šè¡¨ï¼Œå°±æ˜¯è§†å›¾ã€‚  
> æŸ¥è¯¢çš„æ•°æ®æ¥æºäºä¸åŒçš„è¡¨ï¼Œè€ŒæŸ¥è¯¢è€…å¸Œæœ›ä»¥ç»Ÿä¸€çš„æ–¹å¼æŸ¥è¯¢ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ªè§†å›¾ï¼ŒæŠŠå¤šä¸ªè¡¨æŸ¥è¯¢ç»“æœè”åˆèµ·æ¥ï¼ŒæŸ¥è¯¢è€…åªéœ€è¦ç›´æ¥ä»è§†å›¾ä¸­è·å–æ•°æ®ï¼Œä¸å¿…è€ƒè™‘æ•°æ®æ¥æºäºä¸åŒè¡¨æ‰€å¸¦æ¥çš„å·®å¼‚

#### è§†å›¾çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
> æ•°æ®åº“è§†å›¾éšè—äº†æ•°æ®çš„å¤æ‚æ€§ã€‚  
> æ•°æ®åº“è§†å›¾æœ‰åˆ©äºæ§åˆ¶ç”¨æˆ·å¯¹è¡¨ä¸­æŸäº›åˆ—çš„è®¿é—®ã€‚  
> æ•°æ®åº“è§†å›¾ä½¿ç”¨æˆ·æŸ¥è¯¢å˜å¾—ç®€å•ã€‚

#### äº‹åŠ¡çš„ç‰¹æ€§æœ‰å“ªäº›ï¼Ÿ
1. åŸå­æ€§(Atomicity)ï¼šäº‹åŠ¡ä¸­çš„å…¨éƒ¨æ“ä½œåœ¨æ•°æ®åº“ä¸­æ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå‡ä¸æ‰§è¡Œã€‚  
2. ä¸€è‡´æ€§(Consistency)ï¼šå‡ ä¸ªå¹¶è¡Œæ‰§è¡Œçš„äº‹åŠ¡ï¼Œå…¶æ‰§è¡Œç»“æœå¿…é¡»ä¸æŒ‰æŸä¸€é¡ºåºä¸²è¡Œæ‰§è¡Œçš„ç»“æœç›¸ä¸€è‡´ã€‚  
3. éš”ç¦»æ€§(Isolation)ï¼šäº‹åŠ¡çš„æ‰§è¡Œä¸å—å…¶ä»–äº‹åŠ¡çš„å¹²æ‰°ï¼Œäº‹åŠ¡æ‰§è¡Œçš„ä¸­é—´ç»“æœå¯¹å…¶ä»–äº‹åŠ¡å¿…é¡»æ˜¯é€æ˜çš„ã€‚  
4. æŒä¹…æ€§(Durability)ï¼šå¯¹äºä»»æ„å·²äº¤äº‹åŠ¡ï¼Œç³»ç»Ÿå¿…é¡»ä¿è¯è¯¥äº‹åŠ¡å¯¹æ•°æ®åº“çš„æ”¹å˜ä¸è¢«ä¸¢å¤±ã€‚

#### æ•°æ®åº“æ€ä¹ˆä¼˜åŒ–æŸ¥è¯¢æ•ˆç‡ï¼Ÿ
1. é¿å…æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå¦‚ORã€LIKEç­‰ï¼Œå› ä¸ºä¼šå¯¼è‡´å…¨è¡¨æ‰«æï¼›
2. åœ¨å¸¸ç”¨å­—æ®µåŠ ç´¢å¼•ï¼Œä¾‹å¦‚WHEREã€JOIN ONå’ŒORDER BYä½¿ç”¨åˆ°å­—æ®µä¸Šåº”è¯¥åŠ ç´¢å¼•
3. å°½é‡é¿å…å…¨å±€æ€§çš„è¯»å†™æ“ä½œï¼Œä¾‹å¦‚SELECT * ã€Updateå…¨éƒ¨å­—æ®µ

#### äº†è§£æ•°æ®åº“ä¼˜åŒ–æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ
1. ä¼˜åŒ–ç´¢å¼•ã€SQL è¯­å¥ã€åˆ†ææ…¢æŸ¥è¯¢;
2. è®¾è®¡è¡¨çš„æ—¶å€™ä¸¥æ ¼æ ¹æ®æ•°æ®åº“çš„è®¾è®¡èŒƒå¼æ¥è®¾è®¡æ•°æ®åº“;
3. ä½¿ç”¨ç¼“å­˜ï¼ŒæŠŠç»å¸¸è®¿é—®åˆ°çš„æ•°æ®è€Œä¸”ä¸éœ€è¦ç»å¸¸å˜åŒ–çš„ æ•°æ®æ”¾åœ¨ç¼“å­˜ä¸­ï¼Œèƒ½èŠ‚çº¦ç£ç›˜ IO;
4. ä¼˜åŒ–ç¡¬ä»¶;é‡‡ç”¨ SSDï¼Œä½¿ç”¨ç£ç›˜é˜Ÿåˆ—æŠ€æœ¯ (RAID0,RAID1,RDID5)ç­‰;
5. é‡‡ç”¨ MySQL å†…éƒ¨è‡ªå¸¦çš„è¡¨åˆ†åŒºæŠ€æœ¯ï¼ŒæŠŠæ•°æ®åˆ†å±‚ä¸åŒ çš„æ–‡ä»¶ï¼Œèƒ½å¤Ÿæé«˜ç£ç›˜çš„è¯»å–æ•ˆç‡;
6. å‚ç›´åˆ†è¡¨;æŠŠä¸€äº›ä¸ç»å¸¸è¯»çš„æ•°æ®æ”¾åœ¨ä¸€å¼ è¡¨é‡Œï¼ŒèŠ‚çº¦ ç£ç›˜ I/O;
7. ä¸»ä»åˆ†ç¦»è¯»å†™;é‡‡ç”¨ä¸»ä»å¤åˆ¶æŠŠæ•°æ®åº“çš„è¯»æ“ä½œå’Œå†™å…¥æ“ä½œåˆ†ç¦»å¼€æ¥;
8. åˆ†åº“åˆ†è¡¨åˆ†æœºå™¨(æ•°æ®é‡ç‰¹åˆ«å¤§)ï¼Œä¸»è¦çš„çš„åŸç†å°±æ˜¯æ•°æ®è·¯ç”±;
9. é€‰æ‹©åˆé€‚çš„è¡¨å¼•æ“ï¼Œå‚æ•°ä¸Šçš„ä¼˜åŒ–;
10. è¿›è¡Œæ¶æ„çº§åˆ«çš„ç¼“å­˜ï¼Œé™æ€åŒ–å’Œåˆ†å¸ƒå¼;
11. ä¸é‡‡ç”¨å…¨æ–‡ç´¢å¼•;
12. é‡‡ç”¨æ›´å¿«çš„å­˜å‚¨æ–¹å¼ï¼Œä¾‹å¦‚ NoSQL å­˜å‚¨ç»å¸¸è®¿é—®çš„æ•°

#### å†™ä¸€æ¡ SQL æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ
> å‘½ä¸­ç´¢å¼•

#### äº†è§£joinä¹ˆï¼Œæœ‰å‡ ç§ï¼Œæœ‰ä½•åŒºåˆ«? 
pass

---

#### MySQL çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ
> B+æ ‘

#### MySQL çš„ä¸¤ç§å¼•æ“æ˜¯ä»€ä¹ˆï¼Ÿ
> InnoDB å’Œ MyISAM  
InnoDB æ”¯æŒäº‹åŠ¡ï¼ŒMyISAM ä¸æ”¯æŒäº‹åŠ¡  
InnoDB æ”¯æŒå¤–é”®ï¼ŒMyISAM ä¸æ”¯æŒ  
InnoDB æ˜¯èšé›†ç´¢å¼•ï¼ŒMyISAM æ˜¯éèšé›†ç´¢å¼•

#### MySQLé”æœ‰å‡ ç§?
pass

#### æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„?
pass

#### MySQL çš„ char varchar text æœ‰ä½•åŒºåˆ«?
pass

ä¸ºä½•ï¼Œä»¥åŠå¦‚ä½•åˆ†åŒºã€åˆ†è¡¨ï¼›
pass

---

#### å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“ï¼Ÿ
pass

#### MongoDBçš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ
> Bæ ‘

## ğŸ’» æ“ä½œç³»ç»Ÿ

#### æ€ä¹ˆç†è§£åŒæ­¥å¼‚æ­¥ï¼Ÿ
> åŒæ­¥å’Œå¼‚æ­¥å…³æ³¨çš„æ˜¯æ¶ˆæ¯é€šä¿¡æœºåˆ¶
- æ‰€è°“åŒæ­¥ï¼Œå°±æ˜¯åœ¨å‘å‡ºä¸€ä¸ªè°ƒç”¨æ—¶ï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œè¯¥è°ƒç”¨å°±ä¸è¿”å›ï¼›  
è€Œå¼‚æ­¥åˆ™æ˜¯ç›¸åï¼Œè°ƒç”¨åœ¨å‘å‡ºä¹‹åï¼Œè¿™ä¸ªè°ƒç”¨å°±ç›´æ¥è¿”å›äº†ï¼Œæ‰€ä»¥æ²¡æœ‰è¿”å›ç»“æœã€‚  
- ä½ æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ï¼Œå¦‚æœæ˜¯åŒæ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ä¼šè¯´ï¼Œä½ ç¨ç­‰ï¼Œâ€æˆ‘æŸ¥ä¸€ä¸‹"ï¼Œç„¶åå¼€å§‹æŸ¥å•ŠæŸ¥ï¼Œç­‰æŸ¥å¥½äº†ï¼ˆå¯èƒ½æ˜¯5ç§’ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€å¤©ï¼‰å‘Šè¯‰ä½ ç»“æœï¼ˆè¿”å›ç»“æœï¼‰ã€‚  
è€Œå¼‚æ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ç›´æ¥å‘Šè¯‰ä½ æˆ‘æŸ¥ä¸€ä¸‹å•Šï¼ŒæŸ¥å¥½äº†æ‰“ç”µè¯ç»™ä½ ï¼Œç„¶åç›´æ¥æŒ‚ç”µè¯äº†ï¼ˆä¸è¿”å›ç»“æœï¼‰ã€‚ç„¶åæŸ¥å¥½äº†ï¼Œä»–ä¼šä¸»åŠ¨æ‰“ç”µè¯ç»™ä½ ã€‚åœ¨è¿™é‡Œè€æ¿é€šè¿‡â€œå›ç”µâ€è¿™ç§æ–¹å¼æ¥å›è°ƒã€‚

---

#### æ€ä¹ˆç†è§£é˜»å¡éé˜»å¡?
>é˜»å¡å’Œéé˜»å¡å…³æ³¨çš„æ˜¯ç¨‹åºåœ¨ç­‰å¾…è°ƒç”¨ç»“æœï¼ˆæ¶ˆæ¯ï¼Œè¿”å›å€¼ï¼‰æ—¶çš„çŠ¶æ€ã€‚
- é˜»å¡è°ƒç”¨æ˜¯æŒ‡è°ƒç”¨ç»“æœè¿”å›ä¹‹å‰ï¼Œå½“å‰çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ã€‚è°ƒç”¨çº¿ç¨‹åªæœ‰åœ¨å¾—åˆ°ç»“æœä¹‹åæ‰ä¼šè¿”å›ï¼›  
éé˜»å¡è°ƒç”¨æŒ‡åœ¨ä¸èƒ½ç«‹åˆ»å¾—åˆ°ç»“æœä¹‹å‰ï¼Œè¯¥è°ƒç”¨ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚
- ä½ æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ï¼Œä½ å¦‚æœæ˜¯é˜»å¡å¼è°ƒç”¨ï¼Œä½ ä¼šä¸€ç›´æŠŠè‡ªå·±â€œæŒ‚èµ·â€ï¼Œç›´åˆ°å¾—åˆ°è¿™æœ¬ä¹¦æœ‰æ²¡æœ‰çš„ç»“æœï¼Œå¦‚æœæ˜¯éé˜»å¡å¼è°ƒç”¨ï¼Œä½ ä¸ç®¡è€æ¿æœ‰æ²¡æœ‰å‘Šè¯‰ä½ ï¼Œä½ è‡ªå·±å…ˆä¸€è¾¹å»ç©äº†ï¼Œ å½“ç„¶ä½ ä¹Ÿè¦å¶å°”è¿‡å‡ åˆ†é’Ÿcheckä¸€ä¸‹è€æ¿æœ‰æ²¡æœ‰è¿”å›ç»“æœã€‚  
åœ¨è¿™é‡Œé˜»å¡ä¸éé˜»å¡ä¸æ˜¯å¦åŒæ­¥å¼‚æ­¥æ— å…³ã€‚è·Ÿè€æ¿é€šè¿‡ä»€ä¹ˆæ–¹å¼å›ç­”ä½ ç»“æœæ— å…³

---

#### ä»€ä¹ˆæ˜¯è™šæ‹Ÿå†…å­˜?
> è™šæ‹Ÿå†…å­˜åˆ™æ˜¯è™šæ‹Ÿå‡ºæ¥çš„ã€ä½¿ç”¨ç£ç›˜ä»£æ›¿å†…å­˜ã€‚memoryå°±æ˜¯æœºå™¨çš„ç‰©ç†å†…å­˜ï¼Œè¯»å†™é€Ÿåº¦ä½äºcpuä¸€ä¸ªé‡çº§ï¼Œä½†æ˜¯é«˜äºç£ç›˜ä¸æ­¢ä¸€ä¸ªé‡çº§ã€‚  
> æ‰€ä»¥ï¼Œç¨‹åºå’Œæ•°æ®å¦‚æœåœ¨å†…å­˜çš„è¯ï¼Œä¼šæœ‰éå¸¸å¿«çš„è¯»å†™é€Ÿåº¦ã€‚å†…å­˜çš„æ–­ç”µä¸¢å¤±æ•°æ®æ˜¯ä¸€ä¸ªä¸èƒ½æŠŠæ‰€æœ‰æ•°æ®å’Œç¨‹åºéƒ½ä¿å­˜åœ¨å†…å­˜ä¸­å¯¹åŸå› ã€‚  
> å½“å†…å­˜æ²¡æœ‰å¯ç”¨çš„ï¼Œå°±å¿…é¡»è¦æŠŠå†…å­˜ä¸­ä¸ç»å¸¸è¿è¡Œçš„ç¨‹åºç»™è¸¢å‡ºå»ã€‚ä½†æ˜¯è¸¢åˆ°å“ªé‡Œå»ï¼Œè¿™æ—¶å€™swapå°±å‡ºç°äº†ã€‚  
> swapå…¨ç§°ä¸ºswap placeï¼Œå³äº¤æ¢åŒºï¼Œå½“å†…å­˜ä¸å¤Ÿçš„æ—¶å€™ï¼Œè¢«è¸¢å‡ºçš„è¿›ç¨‹è¢«æš‚æ—¶å­˜å‚¨åˆ°äº¤æ¢åŒºã€‚å½“éœ€è¦è¿™æ¡è¢«è¸¢å‡ºçš„è¿›ç¨‹çš„æ—¶å€™ï¼Œå°±ä»äº¤æ¢åŒºé‡æ–°åŠ è½½åˆ°å†…å­˜ï¼Œå¦åˆ™å®ƒä¸ä¼šä¸»åŠ¨äº¤æ¢åˆ°çœŸå®å†…å­˜ä¸­ã€‚

## ğŸ Python è¯­è¨€ç‰¹æ€§

#### é¢å‘å¯¹è±¡çš„ç‰¹ç‚¹ï¼Ÿ
> å°è£…ã€ç»§æ‰¿å’Œå¤šæ€

#### python ä¸€åˆ‡çš†å¯¹è±¡æ€ä¹ˆç†è§£ï¼Ÿ
> type ç±»å®ä¾‹åŒ–äº† object ï¼Œtype ç±»ç”±ç»§æ‰¿è‡ª objectï¼Œè¿™ä¸çŸ›ç›¾ã€‚æ— è®ºæ˜¯ typeï¼Œè¿˜æ˜¯ objectï¼Œå®ƒä»¬å³æ˜¯å¯¹è±¡ï¼Œä¹Ÿæ˜¯ç±»ï¼Œæ‰€ä»¥æ—¢æ‹¥æœ‰å¯¹è±¡çš„ç‰¹æ€§ï¼Œä¹Ÿæ‹¥æœ‰ç±»çš„ç‰¹æ€§ã€‚  
> type æŒç®¡äº†å¯¹è±¡çš„ç‰¹æ€§ï¼Œobject æŒç®¡äº†ç±»çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ä¸¤è€…ç›¸äº’ä¾å­˜ã€‚æˆ‘ä»¬ ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè™šçº¿è¡¨ç¤ºå¯¹è±¡å®ä¾‹åŒ–ç”Ÿæˆå…³ç³»ï¼Œå®çº¿è¡¨ç¤ºç±»çš„ç»§æ‰¿å…³ç³»ã€‚  
> æ‰€æœ‰ç±»éƒ½æ‹¥æœ‰å¯¹è±¡çš„ç‰¹ä¿¡æ¯ï¼Œæ‰€ä»¥éƒ½ç”±typeå®ä¾‹åŒ–ç”Ÿæˆï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ‹¥æœ‰ç±»çš„ç‰¹æ€§ï¼Œæ‰€ä»¥éƒ½ç»§æ‰¿è‡ª objectã€‚  
> ![](https://raw.githubusercontent.com/XuYuanzhe/Figurebed/master/img/20220604170940.png)

#### ä»€ä¹ˆæ˜¯ç±»ï¼Ÿ
> ç±»æ˜¯æ¨¡æ¿ï¼Œè€Œå®ä¾‹åˆ™æ˜¯æ ¹æ®ç±»åˆ›å»ºçš„å¯¹è±¡ã€‚  
> ä½¿ç”¨ç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ç±»çš„æ‰€æœ‰æˆå‘˜ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ“ä½œã€‚

#### ä»€ä¹ˆæ˜¯å…ƒç±»ï¼Ÿ
> å®ä¾‹å¯¹è±¡æ˜¯ç”±ç±»æ¥åˆ›å»ºï¼Œç±»æ˜¯ç”±å…ƒç±»æ¥åˆ›å»ºçš„ã€‚pythonçš„ç±»éƒ½æ˜¯ç”± `type` ç±»ç»§æ‰¿çš„ï¼Œå¯ä»¥æƒ³è±¡ä¸ºå…ƒç±»æ˜¯ä¸€ä¸ªç±»çš„çˆ¶ç±»ã€‚åœ¨Djangoä¸­å¤šç”¨å…ƒç±»åˆ›å»ºè¯­æ³•ç³–ã€‚  
> [Python MetaClass Notes](https://github.com/XuYuanzhe/XuYuanzhe/blob/main/documents/PythonMetaClass.md)

#### Python çš„è£…é¥°å™¨æ€ä¹ˆç†è§£ï¼Ÿå†…éƒ¨å®ç°åŸç†ï¼Ÿ
> è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªPythonå‡½æ•°ï¼Œæ˜¯é—­åŒ…çš„ä¸€ç§å®ç°, å®ƒçš„ä½œç”¨æ˜¯è®©å…¶ä»–å‡½æ•°åœ¨ä¸éœ€è¦åšä»»ä½•ä»£ç å˜åŠ¨çš„å‰æä¸‹å¢åŠ é¢å¤–åŠŸèƒ½ã€‚  
> ä½¿ç”¨è£…é¥°å™¨çš„æ—¶å€™, è§£æå™¨æŠŠè¢«è£…é¥°çš„å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™è£…é¥°å™¨, ç„¶åå†è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡, è£…é¥°å™¨å†…éƒ¨å®ç°éœ€è¦é¢å¤–å¢åŠ çš„åŠŸèƒ½å’Œè¢«è£…é¥°å‡½æ•°çš„åŠŸèƒ½,è™½ç„¶è¢«è£…é¥°å‡½æ•°çš„è°ƒç”¨æ–¹æ³•æ²¡æœ‰æ”¹å˜, ä½†å®é™…ä¸Šå·²ç»ä¸æ˜¯åŸæ¥å‡½æ•°, è€Œå˜æˆäº†è£…é¥°å™¨è¿”å›çš„å‡½æ•°å¯¹è±¡  
> å®ƒç»å¸¸ç”¨äºæœ‰åˆ‡é¢éœ€æ±‚çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼šæ’å…¥æ—¥å¿—ã€æ€§èƒ½æµ‹è¯•ã€äº‹åŠ¡å¤„ç†ã€ç¼“å­˜ã€æƒé™æ ¡éªŒç­‰åœºæ™¯ã€‚  
 
#### ä»€ä¹ˆæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹AOP?  
> åœ¨è¿è¡Œæ—¶ï¼ŒåŠ¨æ€åœ°å°†ä»£ç åˆ‡å…¥åˆ°ç±»çš„æŒ‡å®šæ–¹æ³•ã€æŒ‡å®šä½ç½®ä¸Šçš„ç¼–ç¨‹æ€æƒ³å°±æ˜¯é¢å‘åˆ‡é¢çš„ç¼–ç¨‹ã€‚  

#### æ‰‹å†™ä¸€ä¸ªæ™®é€šè£…é¥°å™¨ï¼Œä¸€ä¸ªå¸¦å‚è£…é¥°å™¨ï¼Ÿ
```python
import functools

# æ™®é€šè£…é¥°å™¨
def decorator(fn):
  context = 1
  
  @functools.wraps(fn)
  def wrapper(*args, **kwargs):
    print("context", context)
    return fn(*args, **kwargs)
  return wrapper


@decorator
def func():
  print("I am target")

func()


#å¸¦å‚æ•°çš„è£…é¥°å™¨
def decorator_out(context):
    def decorator(fn):
        @functools.wraps(fn)
        def wrapper(*args, **kwargs):
            print("context", context)
            return fn(*args, **kwargs)
        return wrapper
    return decorator


@decorator_out(3)
def test(*args, **kwargs):
    print(1)

test()
```

#### @staticmethod & @classmethod æœ‰ä½•åŒºåˆ«ï¼Ÿ
> Python æœ‰ 3 ä¸ªæ–¹æ³•,é™æ€æ–¹æ³•,ç±»æ–¹æ³•,å®ä¾‹æ–¹æ³•
```python
def foo(x):
    print("executing foo(%s)" % x)


class A(object):
    # å®ä¾‹æ–¹æ³•
    def foo(self, x):
        print("executing foo(%s,%s)" % (self, x))

    # ç±»æ–¹æ³•
    @classmethod
    def class_foo(cls,x):
        print("executing class_foo(%s,%s)" % (cls, x))

    # é™æ€æ–¹æ³•
    @staticmethod
    def static_foo(x):
        print("executing static_foo(%s)" % x)


a = A()
```

| \\      | å®ä¾‹æ–¹æ³•    | ç±»æ–¹æ³•            | é™æ€æ–¹æ³•            |
| :------ | :-------   | :------------- | :-------------- |
| a = A() | a.foo(x)   | a.class_foo(x) | a.static_foo(x) |
| A       | ä¸å¯ç”¨      | A.class_foo(x) | A.static_foo(x) |


#### è§£é‡Šä¸€ä¸‹å®ä¾‹æ–¹æ³•ä¸­çš„ self
> åœ¨ç±»é‡Œæ¯æ¬¡å®šä¹‰æ–¹æ³•çš„æ—¶å€™éƒ½éœ€è¦ç»‘å®šå®ä¾‹,ä¹Ÿå°±æ˜¯foo(self, x)  
> å› ä¸ºå®ä¾‹æ–¹æ³•çš„è°ƒç”¨ç¦»ä¸å¼€å®ä¾‹,æˆ‘ä»¬éœ€è¦æŠŠå®ä¾‹è‡ªå·±ä¼ ç»™å‡½æ•°,è°ƒç”¨çš„æ—¶å€™æ˜¯è¿™æ ·çš„ a.foo(x) ä½†å…¶å®æ˜¯foo(a, x)
---

#### é­”æœ¯æ–¹æ³•çš„åŒä¸‹åˆ’çº¿æ„ä¹‰ä½•åœ¨ï¼Ÿ
> åªæ˜¯ä¸€ç§çº¦å®š,Python å†…éƒ¨çš„åå­—,ç”¨æ¥åŒºåˆ«å…¶ä»–ç”¨æˆ·è‡ªå®šä¹‰çš„å‘½å,ä»¥é˜²å†²çª

#### å°†åˆ—è¡¨ç”Ÿæˆå¼ä¸­ [] æ”¹æˆ () ä¹‹åæ•°æ®ç»“æ„æ˜¯å¦æ”¹å˜?
> æ˜¯ï¼Œä»åˆ—è¡¨å˜ä¸ºç”Ÿæˆå™¨

#### iterator & generator
> å¯è¿­ä»£çš„å¯¹è±¡çš„æ„æ€æ˜¯å°±æ˜¯è¯´è¿™ä¸ªå®ä½“æ˜¯å¯è¿­ä»£çš„ï¼Œä¾‹å¦‚å­—ç¬¦ã€åˆ—è¡¨ã€å…ƒç»„ã€å­—å…¸ã€è¿­ä»£å™¨ç­‰ç­‰ï¼Œå¯ä»¥ç”¨for ... inè¿›è¡Œå¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨forå¾ªç¯è¿­ä»£çš„æ ‡å¿—æ˜¯å†…éƒ¨å®ç°äº†`__iter__`æ–¹æ³•ã€‚  
> åœ¨ py2 ä¸­ range å’Œ xrange å‰è€…è¿”å›liståè€…è¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œä¸ä¼šä¸€ä¸‹å­å¼€è¾Ÿå‡ºæ‰€æœ‰çš„å†…å­˜ç©ºé—´ï¼Œè¾¹å¾ªç¯ï¼Œè¾¹è®¡ç®—ã€‚

#### new & init
- __new__æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•,è€Œ__init__æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•.
- __new__æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªåˆ›å»ºçš„å®ä¾‹,è€Œ__init__ä»€ä¹ˆéƒ½ä¸è¿”å›.
- åªæœ‰åœ¨__new__è¿”å›ä¸€ä¸ªclsçš„å®ä¾‹æ—¶åé¢çš„__init__æ‰èƒ½è¢«è°ƒç”¨.
- å½“åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹æ—¶è°ƒç”¨__new__,åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹æ—¶ç”¨__init__.

#### æ‰‹å†™ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Ÿè¯´è¯´ç†è§£
```python
class Singleton(object):
    def __new__(cls, *args, **kwargs):
        if not hasattr(cls, '_instance'):
            orig = super(Singleton, cls)
            cls._instance = orig.__new__(cls, *args, **kwargs)
        return cls._instance


class MyClass(Singleton):
    a = 1
```
> é€šè¿‡å•ä¾‹æ¨¡å¼å¯ä»¥ä¿è¯ç³»ç»Ÿä¸­ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹è€Œä¸”è¯¥å®ä¾‹æ˜“äºå¤–ç•Œè®¿é—®ï¼Œä»è€Œæ–¹ä¾¿å¯¹å®ä¾‹ä¸ªæ•°çš„æ§åˆ¶å¹¶èŠ‚çº¦ç³»ç»Ÿèµ„æºã€‚å¦‚æœå¸Œæœ›åœ¨ç³»ç»Ÿä¸­æŸä¸ªç±»çš„å¯¹è±¡åªèƒ½å­˜åœ¨ä¸€ä¸ªï¼Œå•ä¾‹æ¨¡å¼æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚

#### enter & exit
> withæ–¹æ³•å¸®åŠ©å®ç°äº†ä¸€ä¸ª __enter__ å’Œ __exit__ çš„æ–¹æ³•ã€‚è¯»å–å’Œé€€å‡ºçš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œåœ¨æ“ä½œæ–‡ä»¶æˆ–ç½‘ç»œçš„å¼‚æ­¥æ“ä½œçš„æ—¶å€™å¾ˆæœ‰ç”¨ã€‚

---


#### Python ä»£ç æ˜¯æ€æ ·æ‰§è¡Œçš„?
> é¦–å…ˆï¼Œè§£é‡Šå™¨è¯»å–Pythonä»£ç å¹¶æ£€æŸ¥æ˜¯å¦æœ‰è¯­æ³•æˆ–æ ¼å¼é”™è¯¯ã€‚  
> å¦‚æœå‘ç°é”™è¯¯ï¼Œåˆ™æš‚åœæ‰§è¡Œã€‚å¦‚æœæ²¡æœ‰å‘ç°é”™è¯¯ï¼Œåˆ™è§£é‡Šå™¨ä¼šå°†Pythonä»£ç è½¬æ¢ä¸ºç­‰æ•ˆå½¢å¼æˆ–å­—èŠ‚ä»£ç ã€‚  
> ç„¶åå°†å­—èŠ‚ç å‘é€åˆ°Pythonè™šæ‹Ÿæœº(PVM)ï¼Œè¿™é‡ŒPythonä»£ç å°†è¢«æ‰§è¡Œï¼Œå¦‚æœå‘ç°ä»»ä½•é”™è¯¯ï¼Œåˆ™æš‚åœæ‰§è¡Œï¼Œå¦åˆ™ç»“æœå°†æ˜¾ç¤ºåœ¨è¾“å‡ºçª—å£ä¸­ã€‚

#### Python ä¸­å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ  
> æ‰€è°“å¯å˜å¯¹è±¡æ˜¯æŒ‡ï¼Œå¯¹è±¡çš„å†…å®¹æ˜¯å¯å˜çš„ã€‚è€Œä¸å¯å˜çš„å¯¹è±¡åˆ™ç›¸åï¼Œè¡¨ç¤ºå…¶å†…å®¹ä¸å¯å˜ã€‚  
> ä¸å¯å˜å¯¹è±¡(intï¼Œstringï¼Œfloatï¼Œtuple)å¯ç†è§£ä¸ºCä¸­ï¼Œè¯¥å‚æ•°ä¸ºå€¼ä¼ é€’  
> å¯å˜å¯¹è±¡(listï¼Œdict)å¯ç†è§£ä¸ºCä¸­ï¼Œè¯¥å‚æ•°ä¸ºæŒ‡é’ˆä¼ é€’

---

#### python å†…ç½®æœ‰å“ªäº›æ•°å€¼ç±»å‹ï¼Ÿ
- æ•´å‹ï¼ˆintï¼‰
- æµ®ç‚¹æ•°ï¼ˆfloatï¼‰
- å¸ƒå°”å‹ï¼ˆboolï¼‰
- å¤æ•°ï¼ˆcomplexï¼‰

#### python å†…ç½®æœ‰å“ªäº›æ•°æ®ç»“æ„?
- List åˆ—è¡¨ï¼šæœ‰åºã€å¯å˜ã€å¯è¿­ä»£ã€‚
- Tuple å…ƒç»„ï¼šæœ‰åºã€ä¸å¯å˜ã€å¯è¿­ä»£ã€‚
- Dict å­—å…¸ï¼šå¯å˜
- Set é›†åˆ

#### List æ‹“å±•æœ‰å“ªäº›æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
- appendï¼šåœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°å…ƒç´ ã€‚
- insertï¼šåœ¨åˆ—è¡¨çš„ç‰¹å®šä½ç½®æ·»åŠ å…ƒç´ ã€‚
- extendï¼šé€šè¿‡æ·»åŠ æ–°åˆ—è¡¨æ¥æ‰©å±•åˆ—è¡¨ã€‚

#### Dict çš„åº•å±‚ä½¿ç”¨ä»€ä¹ˆå®ç°çš„ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
> dict çš„åº•å±‚æ˜¯ hashmap å®ç°çš„, æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1),

#### Python å·²ç»æœ‰ list ç»“æ„ä¸ºä»€ä¹ˆè¿˜è¦æœ‰ tuple?
> 1.æ›´çœå†…å­˜ã€‚Tuple åœ¨å†…å­˜å’Œå¤„ç†é€Ÿåº¦ä¸Šéƒ½ä¼˜äº List
> 2.å¯å“ˆå¸Œã€‚å› æ­¤ Tuple å¯ä»¥å†…åµŒåœ¨ Dict é‡Œé¢
> 3.çº¿ç¨‹å®‰å…¨ã€‚å› ä¸º Tupleæ˜¯åªè¯»çš„, è¿™å°±ä½¿å¾—å®ƒå¤©ç”Ÿèƒ½é¿å…è¯»å†™å†²çªå’Œå†™å†™å†²çªï¼Œåœ¨å¤šçº¿ç¨‹æ—¶å€™å¯ä»¥å¤§èƒ†æ”¾å¿ƒçš„ä½¿ç”¨, pythonåº•å±‚ä¸­ä¹Ÿç”¨äº†å¾ˆå¤štuple.

#### python æ˜¯å¦‚ä½•ç®¡ç†å†…å­˜çš„ï¼Ÿ
> æ‰€æœ‰çš„ Python å¯¹è±¡å’Œæ•°æ®ç»“æ„éƒ½ä½äºä¸€ä¸ªç§æœ‰å †ä¸­ã€‚ç§ç”¨å †çš„åˆ†é…ç”± Python å†…å­˜ç®¡ç†å™¨è´Ÿè´£ã€‚  
> Python è¿˜å†…ç½®äº†ä¸€ä¸ªçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¯ä»¥å›æ”¶æœªä½¿ç”¨çš„å†…å­˜å¹¶é‡Šæ”¾å†…å­˜ï¼Œä½¿å…¶å¯ç”¨äº headspaceã€‚

#### å¦‚ä½•é¿å…å¾ªç¯å¼•ç”¨?
> https://zhuanlan.zhihu.com/p/124290355  
- å¼•ç”¨è®¡æ•°  
å½“ä¸€ä¸ªå¯¹è±¡æœ‰æ–°çš„å¼•ç”¨æ—¶ï¼Œå¯¹è±¡çš„å¼•ç”¨è®¡æ•°+1ï¼›å½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è¢«é”€æ¯æ—¶ï¼Œå¯¹è±¡çš„å¼•ç”¨è®¡æ•°-1ï¼›
- åˆ†ä»£å›æ”¶  
å¾ªç¯å¼•ç”¨å¯¼è‡´å¼•ç”¨è®¡æ•°ä¸èƒ½æ¸…é›¶ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼›å‡½æ•°çš„å‚æ•°é€‚ç”¨äº†å¯å˜å˜é‡ `list` `dict`  è€Œé»˜è®¤ä¸æ˜¯è¿™ç§å¯å˜å˜é‡
- æ ‡è®°-æ¸…é™¤  
å¦‚æœå¾ªç¯å¼•ç”¨ä¸­ï¼Œä¸¤ä¸ªå¯¹è±¡éƒ½å®šä¹‰äº† `__del__` æ–¹æ³•ï¼Œgcæ¨¡å—ä¸ä¼šé”€æ¯è¿™ä¸¤ä¸ªä¸å¯è¾¾å¯¹è±¡ï¼Œå› ä¸ºgcæ¨¡å—ä¸çŸ¥é“åº”è¯¥å…ˆè°ƒç”¨å“ªä¸ªå¯¹è±¡çš„ `__del__` æ–¹æ³•  
ä¾‹å¦‚ï¼Œä¸¤ä¸ªå¯¹è±¡aå’Œbï¼Œå¦‚æœå…ˆé”€æ¯aï¼Œåˆ™åœ¨é”€æ¯bæ—¶ï¼Œä¼šè°ƒç”¨bçš„ `__del__` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­å¾ˆå¯èƒ½ä½¿ç”¨äº†aï¼Œè¿™æ—¶ä¼šé€ æˆå¼‚å¸¸ï¼Œ  
æ‰€ä»¥ä¸ºäº†å®‰å…¨èµ·è§ï¼Œgcæ¨¡å—ä¼šæŠŠå¯¹è±¡æ”¾åˆ° gc.garbage ä¸­ï¼Œå¹¶æŠŠå®ƒä»¬ç§°ä¸º uncollectableã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ç§æƒ…å†µä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œ  
è¦è§£å†³çš„è¯ï¼Œåªèƒ½æ˜¾å¼è°ƒç”¨å…¶ä¸­æŸä¸ªå¯¹è±¡çš„ `__del__` æ–¹æ³•æ¥æ‰“ç ´åƒµå±€ã€‚

---

#### è§£é‡Šä¸€ä¸‹ GIL é”
> ä¸€ä¸ªæ ¸åªèƒ½åœ¨åŒä¸€æ—¶é—´è¿è¡Œä¸€ä¸ªçº¿ç¨‹.å¯¹äºioå¯†é›†å‹ä»»åŠ¡ï¼Œpythonçš„å¤šçº¿ç¨‹èµ·åˆ°ä½œç”¨ï¼Œä½†å¯¹äºcpuå¯†é›†å‹ä»»åŠ¡ï¼Œpythonçš„å¤šçº¿ç¨‹å‡ ä¹å ä¸åˆ°ä»»ä½•ä¼˜åŠ¿ï¼Œè¿˜æœ‰å¯èƒ½å› ä¸ºäº‰å¤ºèµ„æºè€Œå˜æ…¢

#### è§£é‡Šä¸€ä¸‹è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹
- è¿›ç¨‹ï¼šæ˜¯CPUå¯¹ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ã€ä¸€æ¬¡æ‰§è¡Œä»»åŠ¡ã€‚å„ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ã€æ•°æ®æ ˆç­‰ã€‚
- çº¿ç¨‹ï¼šæ˜¯è¿›ç¨‹ä¸­æ‰§è¡Œè¿ç®—çš„æœ€å°å•ä½ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ä½“ã€‚
- åç¨‹ï¼šæ¯”çº¿ç¨‹æ›´å°çš„æ‰§è¡Œå•å…ƒï¼Œåˆç§°å¾®çº¿ç¨‹ï¼Œåœ¨å•çº¿ç¨‹ä¸Šæ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè‡ªå¸¦CPUä¸Šä¸‹æ–‡ã€‚æƒ³è¦ä½¿ç”¨åç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä»»åŠ¡å¿…é¡»æœ‰ç­‰å¾…ã€‚  
å½“æˆ‘ä»¬è¦å®Œæˆçš„ä»»åŠ¡æœ‰è€—æ—¶ä»»åŠ¡ï¼Œå±äºIOå¯†é›†å‹ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨åç¨‹æ¥æ‰§è¡Œä»»åŠ¡ä¼šèŠ‚çœå¾ˆå¤šçš„èµ„æºã€‚

#### python æ€ä¹ˆå®ç°å¤šçº¿ç¨‹ï¼Ÿ
> pythonä½¿ç”¨`threading`å®ç°å¤šçº¿ç¨‹ï¼Œä½¿ç”¨`gevent + asyncio`å®ç°æºç¨‹ã€‚åœ¨Pythonçš„è¿›ç¨‹é‡Œåªæœ‰ä¸€ä¸ªGILã€‚ä¸€ä¸ªçº¿ç¨‹éœ€è¦æ‰§è¡Œä»»åŠ¡ï¼Œå¿…é¡»è·å–GILã€‚  
- å¥½å¤„ï¼šç›´æ¥æœç»äº†å¤šä¸ªçº¿ç¨‹è®¿é—®å†…å­˜ç©ºé—´çš„å®‰å…¨é—®é¢˜ã€‚  
- åå¤„ï¼šPythonçš„å¤šçº¿ç¨‹ä¸æ˜¯çœŸæ­£å¤šçº¿ç¨‹ï¼Œä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸CPUçš„èµ„æºã€‚

#### python çš„å¤šçº¿ç¨‹ä¸æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ï¼Ÿ
> å¤šçº¿ç¨‹æœ‰ä¸¤ä¸ªå¥½å¤„ï¼šCPUå¹¶è¡Œï¼ŒIOå¹¶è¡Œã€‚  
> Pythonè™½ç„¶ä¸èƒ½åˆ©ç”¨å¤šçº¿ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ï¼Œä½†å¯ä»¥é€šè¿‡å¤šè¿›ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ã€‚å¤šä¸ªPythonè¿›ç¨‹æœ‰å„è‡ªç‹¬ç«‹çš„GILé”ï¼Œäº’ä¸å½±å“ã€‚  
> å¤šæ ¸å¤šçº¿ç¨‹æ¯”å•æ ¸å¤šçº¿ç¨‹æ›´å·®ï¼ŒåŸå› æ˜¯å•æ ¸ä¸‹çš„å¤šçº¿ç¨‹ï¼Œæ¯æ¬¡é‡Šæ”¾GILï¼Œå”¤é†’çš„é‚£ä¸ªçº¿ç¨‹éƒ½èƒ½è·å–åˆ°GILé”ï¼Œæ‰€ä»¥èƒ½å¤Ÿæ— ç¼æ‰§è¡Œï¼Œä½†å¤šæ ¸ä¸‹ï¼ŒCPU0é‡Šæ”¾GILåï¼Œå…¶ä»–CPUä¸Šçš„çº¿ç¨‹éƒ½ä¼šè¿›è¡Œç«äº‰ï¼Œ  
> ä½†GILå¯èƒ½ä¼šé©¬ä¸Šåˆè¢«CPU0æ‹¿åˆ°ï¼Œå¯¼è‡´å…¶ä»–å‡ ä¸ªCPUä¸Šè¢«å”¤é†’åçš„çº¿ç¨‹ä¼šé†’ç€ç­‰å¾…åˆ°åˆ‡æ¢æ—¶é—´ååˆè¿›å…¥å¾…è°ƒåº¦çŠ¶æ€ï¼Œè¿™æ ·ä¼šé€ æˆçº¿ç¨‹é¢ ç°¸(thrashing)ï¼Œå¯¼è‡´æ•ˆç‡æ›´ä½

#### å¦‚ä½•æœ€å¤§æ€§èƒ½æ‰§è¡Œ python
> æ›´æ¨èå¤šè¿›ç¨‹è€Œä¸æ˜¯å¤šçº¿ç¨‹

---

#### ä¸ºä»€ä¹ˆpythonä»£ç æ‰§è¡Œç¼“æ…¢ï¼Ÿ
> å› ä¸ºå®ƒæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ã€‚å®ƒçš„ä»£ç åœ¨è¿è¡Œæ—¶è¿›è¡Œè§£é‡Šï¼Œè€Œä¸æ˜¯ç¼–è¯‘ä¸ºæœ¬åœ°è¯­è¨€ã€‚

####å¦‚ä½•æé«˜æ‰§è¡Œé€Ÿåº¦ï¼Ÿ
> å¯ä»¥ä½¿ç”¨CPythonã€Numbaï¼Œæˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ä»£ç è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚é¦–å…ˆçœ‹ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œå¦‚æœåœ¨CPUè®¡ç®—æ¯”è¾ƒé‡å¯ä»¥ç”¨cå®ç°ä¸€ä¸‹ï¼›  
> å¦‚æœæ˜¯è·Ÿcodeå…³ç³»ä¸å¤§ä¸»è¦æ˜¯ç½‘ç»œæ•°æ®åº“è¿™ä¸€å—ï¼Œå°±è¦çœ‹sqlè¯­æ³•å’Œæºç¨‹è°ƒç”¨æœ‰æ²¡æœ‰å……åˆ†ä½¿ç”¨ï¼›`line_profiler` åœ¨codeé‡Œå†™ä¸Šå¯ä»¥å¸®åŠ©åˆ†æè¿™ä¸€å—çš„æ€§èƒ½ï¼›  
> `cProfiler` å¸®åŠ©åˆ†ææ•´ä½“æ€§èƒ½ï¼›ç«ç„°å›¾   

## ğŸ› ï¸ åº”ç”¨æ¡†æ¶

#### Django å’Œ Tornado çš„å…³ç³»ã€å·®åˆ«åœ¨å“ªé‡Œï¼Ÿ
pass

#### MVC / MTVï¼›
pass

#### ç¼“å­˜æ€ä¹ˆç”¨ï¼›
pass

#### ä¸­é—´ä»¶æ˜¯å¹²å˜›çš„ï¼›
pass

#### CSRFæ˜¯ä»€ä¹ˆï¼Œdjangoæ˜¯å¦‚ä½•é¿å…çš„ï¼›XSSå‘¢ï¼›
pass

#### å¦‚æœä½ æ¥è®¾è®¡loginï¼Œç®€å•çš„è¯´ä¸€ä¸‹æ€è·¯ï¼›
pass

#### sessionå’Œcookieçš„è”ç³»ä¸åŒºåˆ«ï¼›sessionä¸ºä»€ä¹ˆè¯´æ˜¯å®‰å…¨çš„ï¼›
pass

#### uWSGIå’ŒNginxçš„ä½œç”¨ï¼›
pass

---

#### scrapy æ¡†æ¶å·¥ä½œæµç¨‹

![](https://raw.githubusercontent.com/XuYuanzhe/Figurebed/master/img/20210922172935.png)
